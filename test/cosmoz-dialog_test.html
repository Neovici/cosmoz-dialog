<!doctype html>
<html>

<head>

    <title>cosmoz-dialog tests</title>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1, user-scalable=yes">

    <script src="../../webcomponentsjs/webcomponents-lite.js"></script>
    <script src="../../web-component-tester/browser.js"></script>
    <link rel="import" href="../cosmoz-dialog.html">

    <style>
        #fitInto {
            position: fixed;
            top: 100px;
            left: 100px;
            width: 200px;
            height: 200px;
        }
    </style>

</head>

<body>

  <div id="fitInto">
  </div>
  
  <test-fixture id="basic">
    <template>
      <cosmoz-dialog with-backdrop>
        <p>Dialog</p>
      </cosmoz-dialog>
    </template>
  </test-fixture>

 

<script>
    suite('fitInto', function() {

        test('backdrop element fills the fitInto element', function(done) {
            var dialog = fixture('basic'),
                fitInto = document.getElementById('fitInto');

            dialog.fitInto = fitInto;
            dialog.addEventListener('iron-overlay-opened', function () {
                // Need to wait a bit before checking backdrop size, 
                // otherwise the getBoundingClientRect on the backdrop element
                // returns wrong values.
                // Might be caused by animations used to render the backdrop.
                Polymer.Base.async(function () {
                    var backdropElementSize = dialog.backdropElement.getBoundingClientRect(),
                        fitIntoSize = fitInto.getBoundingClientRect();

                    assert.equal(backdropElementSize.top, fitIntoSize.top);
                    assert.equal(backdropElementSize.left, fitIntoSize.left);
                    assert.equal(backdropElementSize.width, fitIntoSize.width);
                    assert.equal(backdropElementSize.height, fitIntoSize.height);
                    done();
                }, 10);
            });
            dialog.open();
        
        });
    });
</script>

</body>

</html>
