<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../neon-animation/neon-animation-runner-behavior.html">
<link rel="import" href="../paper-dialog-behavior/paper-dialog-behavior.html">
<link rel="import" href="../paper-dialog-behavior/paper-dialog-shared-styles.html">
<link rel="import" href="../iron-overlay-behavior/iron-overlay-manager.html">

<dom-module id="cosmoz-dialog">
	<template>
		<style include="paper-dialog-shared-styles"></style>
		<slot></slot>
	</template>
</dom-module>

<script>

(function() {

	Polymer({

		is: 'cosmoz-dialog',

		behaviors: [
			Polymer.PaperDialogBehavior,
			Polymer.NeonAnimationRunnerBehavior
		],

		listeners: {
			'neon-animation-finish': '_onNeonAnimationFinish'
		},

		_renderOpened: function() {
			this.cancelAnimation();
			this.playAnimation('entry');
		},

		_renderClosed: function() {
			this.cancelAnimation();
			this.playAnimation('exit');
		},

		_onNeonAnimationFinish: function() {
			if (this.opened) {
				this._finishRenderOpened();
			} else {
				this._finishRenderClosed();
			}
		},

		attached: function () {
			// Create a local backdrop element within the view
			var backdropElement = document.createElement('iron-overlay-backdrop');
			Polymer.dom(this).parentNode.appendChild(backdropElement);
			this._manager._backdropElement = backdropElement;
		}

	});

})();

</script>
